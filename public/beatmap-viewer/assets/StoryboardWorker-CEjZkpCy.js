var m=Object.defineProperty;var u=(t,e,s)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var c=(t,e,s)=>u(t,typeof e!="symbol"?e+"":e,s);(function(){"use strict";const e=class e{static get currentTime(){return e._currentTime}static set currentTime(i){e._currentTime=i}static getCurrentTime(){return this.isPlaying?this.currentTime+(performance.now()-this.absStartTime)*e.playbackRate+(e.mods.DT?-40:0):this.currentTime+(e.mods.DT?-40:0)}static getObjects(i=!1){const r=this.getCurrentTime(),n=(a,d)=>a.endTime+100<d?-1:a.startTime-100>d?1:0,o=this.objectsByEnd.filter(a=>n(a,r)===0);o.sort((a,d)=>a.idx-d.idx);const l=[];this.filtered.forEach(a=>{o.length>0&&n(a,r)===0||l.push(a)});const f=[];return o.forEach(a=>{this.filtered.length>0&&this.filtered.includes(a)||f.push(a)}),this.filtered=[...o],{removed:l,add:f,filtered:this.filtered}}static loop(){if(this._renderStart=performance.now(),this.objectsByStart.length>0&&this.objectsByEnd.length>0){const i=this.getObjects(),r=this.getCurrentTime();postMessage({type:"updateOrder",objects:{...i},currentTime:r,lastTime:this.lastTime}),this.lastTime=r}}};c(e,"isPlaying",!1),c(e,"_currentTime",1),c(e,"absStartTime",0),c(e,"lastTime",0),c(e,"playbackRate",1),c(e,"objectsByStart",[]),c(e,"objectsByEnd",[]),c(e,"filtered",[]),c(e,"moddedStats",{approachRate:5,circleSize:5,HPDrainRate:5,overallDifficulty:5,stackLeniency:7,circleDiameter:2*(54.4-4.48*5)*236/256,preempt:1200,fadeIn:800,sliderTickRate:1,radius:54.4-4.48*5,stackOffset:-6.4*(1-.7*0/5)/2}),c(e,"mods",{HR:!1,EZ:!1});let t=e;onmessage=s=>{if(s.data.type==="start"&&(t.isPlaying=!0,t.absStartTime=performance.now()),s.data.type==="stop"&&(t.isPlaying=!1,t.currentTime+=(performance.now()-t.absStartTime)*t.playbackRate),s.data.type==="seek"){const{time:i}=s.data;t.currentTime=i}if(s.data.type==="objects"){const{objects:i}=s.data;t.objectsByStart=i.toSorted((r,n)=>r.startTime-n.startTime),t.objectsByEnd=i.toSorted((r,n)=>r.endTime-n.endTime),console.log(t.objectsByStart,t.objectsByEnd)}if(s.data.type==="updateStats"){const{mods:i,moddedStats:r,playbackRate:n}=s.data;t.mods=i,t.moddedStats=r,t.playbackRate=n}s.data.type==="clear"&&(t.objectsByStart=[],t.objectsByEnd=[],t.filtered=[],t.isPlaying=!1,t.currentTime=1,t.lastTime=0)},setInterval(()=>t.loop(),0)})();
//# sourceMappingURL=StoryboardWorker-CEjZkpCy.js.map
